<header class="header-section">
  <h2>Manage Room Menu</h2>
</header>

@if (isLoading()) {
  <div class="loading-state">Loading drinks...</div>
} @else if (hasError()) {
  <div class="error-message">An error occurred while fetching the drinks.</div>
} @else {
  <div id="menu-grid" class="menu-grid">
    @for (drink of drinks(); track drink.id) {
      <div
        class="drink-card"
        [class.is-expanded]="expandedDrinkId() === drink.id"
        (click)="toggleDetails(drink.id)"
      >
        <!-- Hidden checkbox for model binding -->
        <input type="checkbox" [id]="drink.id" [(ngModel)]="drink.isSelected" />

        <button
          class="select-button"
          [class.is-selected]="drink.isSelected"
          (click)="$event.stopPropagation(); toggleSelection(drink)"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"
            />
          </svg>
        </button>

        <div class="card-content">
          <div class="card-header">
            <h3
              class="drink-name"
              [class.is-hidden]="expandedDrinkId() === drink.id"
            >
              {{ drink.name }}
            </h3>
          </div>

          <!-- Conditionally render the drink details when expanded -->
          @if (expandedDrinkId() === drink.id) {
            <pd-drink-details
              [drink]="drink"
              [class.is-open]="expandedDrinkId() === drink.id"
            ></pd-drink-details>
          }
        </div>
      </div>
    }
  </div>
}

<footer class="footer-section">
  <button
    id="save-button"
    class="save-button"
    [disabled]="isSaving()"
    (click)="saveMenu()"
  >
    {{ isSaving() ? "Saving..." : "Save Changes" }}
  </button>
</footer>
