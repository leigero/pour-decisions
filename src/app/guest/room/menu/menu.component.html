<div class="page-container">
  @if (isLoading()) {
    <div class="loading-state">
      <span class="loading-text">Loading drinks...</span>
    </div>
  } @else if (hasError()) {
    <div class="error-message">
      An error occurred while fetching the drinks.
    </div>
  } @else {
    <div class="search-bar">
      <label class="sr-only" for="drink-search">Search drinks</label>
      <input
        id="drink-search"
        type="search"
        class="search-input"
        [ngModel]="searchTerm()"
        (ngModelChange)="searchTerm.set($event)"
        placeholder="Search by name, ingredient, or description..."
        autocomplete="off"
      />
    </div>

    <div class="menu-groups">
      @for (group of groupedDrinks(); track group.type) {
        <section
          class="menu-group"
          [class.is-collapsed]="isCollapsed(group.type)"
        >
          <button
            type="button"
            class="group-header"
            (click)="toggleGroup(group.type)"
            [attr.aria-expanded]="!isCollapsed(group.type)"
          >
            <h3 class="group-title">{{ formatType(group.type) }}</h3>
            <div class="group-meta">
              <span class="group-count-label">
                {{ group.drinks.length }}
                {{ group.drinks.length === 1 ? "option" : "options" }}
              </span>
              <span
                class="chevron"
                [class.expanded]="!isCollapsed(group.type)"
              ></span>
            </div>
          </button>

          <div
            class="menu-grid"
            [class.is-collapsed]="isCollapsed(group.type)"
            [attr.aria-hidden]="isCollapsed(group.type)"
          >
            <!-- Drink cards will be rendered here -->
            @for (drink of group.drinks; track drink.id) {
              <div class="menu-item" (click)="onViewDetailsClick(drink)">
                <pd-drink-summary [drink]="drink"> </pd-drink-summary>
              </div>
            }
          </div>
        </section>
      } @empty {
        <div class="empty-state">
          {{
            searchTerm().trim()
              ? "No drinks match your search."
              : "No drinks available right now."
          }}
        </div>
      }
    </div>
  }
</div>
